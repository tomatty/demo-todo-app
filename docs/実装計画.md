概要

 アプリ構想に基づき、Next.js + PostgreSQL +
 Prismaを使用したToDoアプリケーションを実装します。

 要件

 - データ項目: タイトル（必須）、説明文（任意）、完了/未完了、作成日時
 - 機能: 新規作成、編集、削除、完了切り替え、一覧表示

 技術スタック

 - Next.js (App Router) + TypeScript
 - Tailwind CSS
 - Lucide React (アイコン)
 - Zod (バリデーション)
 - PostgreSQL (Docker)
 - Prisma (ORM)

 実装手順

 Phase 1: プロジェクトセットアップ

 1. Next.jsプロジェクト初期化
 npx create-next-app@latest . --typescript --tailwind --app --src-dir
 --import-alias "@/*"
   - TypeScript: Yes
   - Tailwind CSS: Yes
   - App Router: Yes
   - src/ directory: Yes
 2. 依存パッケージインストール
 npm install prisma @prisma/client zod lucide-react
 npm install -D prisma
 3. Docker Composeファイル作成
   - docker-compose.yml を作成してPostgreSQLコンテナを定義
   - コンテナ起動: docker-compose up -d
 4. 環境変数設定
   - .env.local を作成してDATABASE_URLを設定

 Phase 2: データベース & バックエンド基盤

 5. Prismaセットアップ
   - prisma/schema.prisma を作成
   - Todoモデル定義（id, title, description, completed, createdAt,
 updatedAt）
   - マイグレーション実行: npx prisma migrate dev --name init
   - Prisma Clientの生成確認
 6. Prisma Clientシングルトン作成
   - src/lib/prisma.ts を作成
 7. 型定義とバリデーション
   - src/types/todo.ts でTypeScript型を定義
   - src/lib/validations.ts でZodスキーマを定義
 8. API Routes実装
   - src/app/api/todos/route.ts: GET（全取得）、POST（新規作成）
   - src/app/api/todos/[id]/route.ts: PUT（更新）、DELETE（削除）
   - Zodによるバリデーション
   - エラーハンドリング

 Phase 3: フロントエンド実装

 9. UIコンポーネント作成
   - src/components/TodoForm.tsx: 新規作成フォーム
   - src/components/TodoItem.tsx:
 個別ToDoアイテム（完了切り替え、編集、削除機能）
 10. メインページ実装
   - src/app/page.tsx: 一覧表示とCRUD操作の統合
   - src/app/layout.tsx: レイアウトとメタデータ設定
 11. スタイリング調整
   - Tailwind CSSでデザイン調整
   - レスポンシブ対応

 Phase 4: テスト & 検証

 12. 動作確認
   - Docker & PostgreSQLの起動確認
   - Prisma Studioでデータベース確認: npx prisma studio
   - 開発サーバー起動: npm run dev
   - 全CRUD操作のテスト
   - バリデーション動作確認

 重要なファイル

 データベース層

 - prisma/schema.prisma: データベーススキーマ定義
 - src/lib/prisma.ts: Prismaクライアントシングルトン
 - docker-compose.yml: PostgreSQLコンテナ設定
 - .env.local: データベース接続情報

 バックエンド層

 - src/app/api/todos/route.ts: GET/POST API
 - src/app/api/todos/[id]/route.ts: PUT/DELETE API
 - src/lib/validations.ts: Zodバリデーションスキーマ
 - src/types/todo.ts: TypeScript型定義

 フロントエンド層

 - src/app/page.tsx: メインページ（ToDo一覧）
 - src/components/TodoForm.tsx: 作成フォーム
 - src/components/TodoItem.tsx: 個別ToDoアイテム
 - src/app/layout.tsx: ルートレイアウト

 検証方法

 1. データベース接続確認

 docker-compose ps
 docker-compose logs postgres
 npx prisma studio

 2. アプリケーション起動

 npm run dev
 # http://localhost:3000

 3. 機能テストチェックリスト

 - ToDo新規作成が動作する
 - タイトル必須バリデーションが動作する
 - ToDo一覧が表示される
 - 完了/未完了の切り替えができる
 - 編集モードに入り、内容を変更できる
 - 削除確認後に削除できる
 - 作成日時が正しく表示される
 - 完了済みToDoが視覚的に区別される

 4. エラーハンドリング確認

 - タイトル未入力で作成を試みる
 - 長すぎるタイトル（200文字以上）を入力する
 - 存在しないIDで更新/削除を試みる

 実装時の注意点

 1. Prismaマイグレーション: 初回は必ず npx prisma migrate dev を実行
 2. 環境変数: .env.local を作成（.env ではない）
 3. Dockerポート: 5432番ポートが空いていることを確認
 4. クライアントコンポーネント: UIコンポーネントには 'use client'
 ディレクティブが必要
 5. 型安全性: Prismaから生成された型を活用してTypeScriptの恩恵を最大限受ける
 6. エラーハンドリング: API呼び出しは必ずtry-catchで囲む

 完了条件

 - Dockerコンテナが正常に起動している
 - データベースマイグレーションが完了している
 - npm run dev でアプリケーションが起動する
 - すべてのCRUD操作（作成、読み取り、更新、削除）が動作する
 - 完了/未完了の切り替えが動作する
 - バリデーションエラーが適切に表示される

 便利なコマンド

# 開発サーバー起動
npm run dev

# Dockerコンテナの管理
docker compose up -d    # 起動
docker compose down     # 停止
docker compose ps       # 状態確認

# Prisma Studio (データベースGUI)
npx prisma studio

# ビルド
npm run build
npm start